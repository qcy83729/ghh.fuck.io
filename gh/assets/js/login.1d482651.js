"use strict";(self["webpackChunkinvestment_advisor_fe"]=self["webpackChunkinvestment_advisor_fe"]||[]).push([[535],{5367:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var i=function(){var e=this,t=e._self._c;return t("div",[t("common-header",{attrs:{title:"交易登录"}}),t("van-form",{ref:"form"},[t("van-field",{attrs:{size:"large",clearable:"",label:"交易账户",name:"account",placeholder:"请输入交易账户",rules:[{required:!0,message:"交易账户不能为空"}]},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}},[e.accountList&&e.accountList.length?t("div",{staticClass:"u-w-100 u-text-center u-type-primary",attrs:{slot:"button"},on:{click:e.changeAccount},slot:"button"},[e._v(" 切换账号 ")]):e._e()]),t("van-field",{attrs:{size:"large",clearable:"",label:"密码",name:"password",type:"password",placeholder:"请输入交易密码",rules:[{required:!0,message:"交易密码不能为空"}]},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),t("van-field",{attrs:{size:"large",label:"图形验证码",name:"imgCode",placeholder:"请输入图形验证码",rules:[{required:!0,message:"图形验证码不能为空"}]},model:{value:e.imgCode,callback:function(t){e.imgCode=t},expression:"imgCode"}},[t("div",{staticClass:"u-w-100 u-text-center",attrs:{slot:"button"},on:{click:e.refreshImgCode},slot:"button"},[e.imgCodeSrc?t("img",{staticClass:"u-h-26",attrs:{src:e.imgCodeSrc,alt:"图形验证码"}}):e._e()])]),e.isphoneRequired?[t("van-field",{attrs:{size:"large",clearable:"",label:"手机号",name:"phone",placeholder:"请输入手机号",rules:[{required:!0,message:"手机号不能为空"},{validator:e.phoneValidator,message:"手机格式不正确"}]},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),t("van-field",{attrs:{size:"large",label:"短信验证码",name:"smsCode",placeholder:"请输入短信验证码",rules:[{required:!0,message:"短信验证码不能为空"}]},model:{value:e.smsCode,callback:function(t){e.smsCode=t},expression:"smsCode"}},[t("div",{staticClass:"u-w-100 u-text-center",attrs:{slot:"button"},slot:"button"},[t("van-button",{attrs:{size:"small",type:"info","native-type":"button",disabled:e.remainTime>0},on:{click:e.sendSms}},[e._v(" "+e._s(e.remainTime>0?`${e.remainTime}s后再次发送`:"发送验证码")+" ")])],1)])]:e._e(),t("van-field",{attrs:{size:"small",name:"checkbox",label:"记住账号"},scopedSlots:e._u([{key:"input",fn:function(){return[t("van-checkbox",{attrs:{"checked-color":e.THEME_COLOR,shape:"square"},model:{value:e.isSavePassword,callback:function(t){e.isSavePassword=t},expression:"isSavePassword"}})]},proxy:!0}])})],2),t("div",{staticClass:"u-m-16"},[t("van-button",{attrs:{block:"",type:"danger"},on:{click:e.onSubmit}},[e._v("登录")])],1),e._m(0),t("van-popup",{attrs:{round:"",position:"bottom"},model:{value:e.showAccounts,callback:function(t){e.showAccounts=t},expression:"showAccounts"}},[t("div",{staticClass:"u-text-center u-p-t-10 u-p-b-10 u-p-l-16 u-p-l-16 u-font-16"},[e._v(" 选择账号 ")]),t("van-cell-group",{staticClass:"u-p-b-16",model:{value:e.account,callback:function(t){e.account=t},expression:"account"}},e._l(e.accountList,(function(n,i){return t("van-cell",{key:i,attrs:{title:n.label},on:{click:function(t){return e.onPickAccount(n,i)}},scopedSlots:e._u([{key:"right-icon",fn:function(){return[t("van-icon",{attrs:{name:"cross"},on:{click:function(t){return t.stopPropagation(),e.onRemoveAccount(n,i)}}})]},proxy:!0}],null,!0)})})),1)],1)],1)},s=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"u-text-center"},[t("div",{staticClass:"u-tips-color u-font-13 u-m-b-10 u-m-t-30"},[e._v(" 没有国海证券账户？ ")]),t("a",{staticClass:"u-type-primary",attrs:{href:"https://tglm.ghzq.com.cn/Guider?busiId=5&planId=2862&channelId=551&staffId=8&marketWay=2"}},[e._v("立即开户")])])}],o=(n(8694),n(1610)),a=(n(8479),n(9146)),r=n(4648),l=(n(1586),n(7837)),c=(n(8838),n(1392)),u=(n(4289),n(4168)),d=(n(2355),n(9233)),h=(n(3474),n(4755)),f=(n(5773),n(5791)),m=(n(3787),n(7221)),p=(n(7141),n(960)),g=(n(7658),function(){var e=this,t=e._self._c;return t("div",{style:{"min-height":e.fixed?44+(e.hideBar?parseInt(e.statusBarHeight):0)+"px":null}},[t("div",{staticClass:"common-header u-relative justify-between u-p-r-10 u-p-t-8 u-p-b-8 align-center",class:{fixed:e.fixed,"u-border-bottom":e.border},style:e.styObj,attrs:{type:e.type},on:{click:e.onClick}},[t("van-icon",{attrs:{name:"arrow-left",size:"30",color:"primary"===e.type?"#fff":"#111"},on:{click:function(t){return t.stopPropagation(),e.onBackClick.apply(null,arguments)}}}),t("div",{staticClass:"common-header-title"},[e._t("title",(function(){return[t("div",{staticClass:"flex1 flex-column flex-center"},[e.subtitle?[t("p",{staticClass:"u-font-15 u-line-1 u-w-245 u-text-center"},[e._v(" "+e._s(e.title)+" ")]),t("p",{staticClass:"u-font-13"},[e._v(e._s(e.subtitle))])]:t("p",{staticClass:"u-font-18 u-line-1 u-w-245 u-text-center"},[e._v(" "+e._s(e.title)+" ")])],2)]}))],2),t("div",{staticClass:"right-action flex-center"},[e._t("action")],2)],1)])}),v=[],b=n(8948),k=n(629),C={name:"CommonHeader",components:{[c.Z.name]:c.Z},props:{title:{type:String,default:null},fixed:{type:Boolean,default:!1},hideBar:{type:Boolean,default:!1},subtitle:{type:String,default:null},type:{type:String,default:"default"},border:{type:Boolean,default:!1},onBack:{type:Function,default:null}},data(){return{THEME_COLOR:b.l1}},computed:(0,r.Z)((0,r.Z)({},(0,k.rn)({statusBarHeight:e=>e.statusBarHeight})),{},{styObj(){const{fixed:e}=this;return e?{"border-top":`${this.statusBarHeight||0}px solid ${b.l1}`}:{}}}),methods:{onBackClick(){this.onBack?this.onBack():history.back()},onClick(){this.$emit("click")}}},y=C,x=n(1001),S=(0,x.Z)(y,g,v,!1,null,"20c4362e",null),w=S.exports,B=n(9176),_=n(2074),Z=n(4675),I=n(7161),A=n.n(I);n(4916),n(5306),n(2325);function $(e,t=0,n=0){const i=e.length,s=e.substring(0,t),o=e.substring(i-n),a=e.substring(t,i-n).replace(/[\s\S]/gi,"*"),r=s+a+o;return r}const L="webMallAccounts";var T={name:"CLogin",components:{CommonHeader:w,[p.Z.name]:p.Z,[m.Z.name]:m.Z,[f.Z.name]:f.Z,[h.Z.name]:h.Z,[d.Z.name]:d.Z,[u.Z.name]:u.Z,[c.Z.name]:c.Z,[l.Z.name]:l.Z},beforeRouteLeave(e,t,n){this.isLogin||_.Z.$emit(Z.kY),n()},data(){const e=localStorage.getItem(L);let t=[];try{t=e?e.split(",").map((e=>({label:$(e,3,2),value:e}))):[]}catch(i){throw console.log(i),i}const n=t.length>0?t[t.length-1]:null;return{showAccounts:!1,accountList:t,account:n&&n.value,password:null,imgCode:null,smsCode:null,phone:null,isSavePassword:!!n,imgCodeSrc:null,isphoneRequired:A().phoneRequired(),remainTime:0,THEME_COLOR:b.l1}},computed:(0,r.Z)({},(0,k.rn)("user",["isLoggingIn"])),created(){this.isLogin=!1,this.getVerifyImg(),this.isLoggingIn||this.$store.dispatch("user/ghLogin",{to:"/"})},methods:{getVerifyImg(){A().ghtradeImgCodeUrl(100,33).then((e=>{this.imgCodeSrc=e}))},changeAccount(){this.showAccounts=!0},onPickAccount(e){this.account=e&&e.value,this.showAccounts=!1},onRemoveAccount(e,t){this.accountList.splice(t,1),localStorage.setItem(L,this.accountList.map((e=>e.value)).join(","))},phoneValidator(e){return(0,B.Mn)(e)},refreshImgCode(){this.imgCode=null,this.getVerifyImg()},sendSms(){this.$refs.form.validate(["phone","imgCode"]).then((()=>{A().ghtradeSendSms(this.phone,this.imgCode).then((()=>{a.Z.success("发送成功"),this.countDown()})).catch((e=>{this.refreshImgCode();let t=e&&e.errMsg||"发送失败";e&&e.detail&&e.detail.errMsg&&(t=e.detail.errMsg),a.Z.fail(t)}))}))},countDown(){this.remainTime=60;const e=setInterval((()=>{this.remainTime--,this.remainTime<=0&&clearInterval(e)}),1e3)},onSubmit(){this.$refs.form.validate().then((()=>{const{account:e,password:t,smsCode:n,phone:i,imgCode:s}=this,r="1",l="stock";let c;c=this.isphoneRequired?[e,r,l,t,n,i]:[e,r,l,t,s],a.Z.loading("登录中"),A().tradeLogin.apply(A(),c).then((t=>{if(A().loginCallback(!0),_.Z.$emit(Z.Ks,t),this.isLogin=!0,this.isSavePassword){const t=this.accountList.map((e=>e&&e.value)),n=t.indexOf(e);if(-1===n)t.push(e),localStorage.setItem(L,t.join(","));else if(t.length>1){const e=t[t.length-1];t[t.length-1]=t[n],t[n]=e,localStorage.setItem(L,t.join(","))}}})).catch((e=>{this.refreshImgCode(),A().loginCallback(!1,e),(0,o.Z)({title:"登录失败",message:e&&e.errMsg||"登录请求异常"})})).finally((()=>{a.Z.clear()}))}))}}},P=T,F=(0,x.Z)(P,i,s,!1,null,null,null),O=F.exports},8948:function(e,t,n){n.d(t,{H4:function(){return o},Jf:function(){return s},l1:function(){return i}});const i="#e41132",s="wxbbd074b0f84c0fa8",o="gh_25e1f0dbd473"},2325:function(e,t,n){n.d(t,{Ds:function(){return o},LC:function(){return i},tJ:function(){return s}});n(4916);function i(e){return null===e||void 0===e||""===e||isNaN(e)?"":parseFloat(e)}function s(e,t=0){const n=`${e}`;if(/^\.\d{1,}$/.test(n))return i(n);const s=n.match(/(-|\+)?\d+(\.\d+)?/g);return"all"===t?Array.isArray(s)?s.map((e=>i(e))):s:s&&s[t]&&i(s[t])}const o=(e,t)=>{let n=null;return function(...i){null!==n&&clearTimeout(n),n=setTimeout((()=>{e.apply(this,i)}),t)}}},7837:function(e,t,n){var i=n(2787),s=n(1085),o=(0,i.d)("checkbox"),a=o[0],r=o[1];t["Z"]=a({mixins:[(0,s.p)({bem:r,role:"checkbox",parent:"vanCheckbox"})],computed:{checked:{get:function(){return this.parent?-1!==this.parent.value.indexOf(this.name):this.value},set:function(e){this.parent?this.setParentValue(e):this.$emit("input",e)}}},watch:{value:function(e){this.$emit("change",e)}},methods:{toggle:function(e){var t=this;void 0===e&&(e=!this.checked),clearTimeout(this.toggleTask),this.toggleTask=setTimeout((function(){t.checked=e}))},setParentValue:function(e){var t=this.parent,n=t.value.slice();if(e){if(t.max&&n.length>=t.max)return;-1===n.indexOf(this.name)&&(n.push(this.name),t.$emit("input",n))}else{var i=n.indexOf(this.name);-1!==i&&(n.splice(i,1),t.$emit("input",n))}}}})},1586:function(e,t,n){n(1958),n(3332),n(6742)},3787:function(e,t,n){n(1958),n(3332),n(6742),n(3094),n(7984)},960:function(e,t,n){var i=n(2787),s=n(1150),o=(0,i.d)("form"),a=o[0],r=o[1];t["Z"]=a({props:{colon:Boolean,disabled:Boolean,readonly:Boolean,labelWidth:[Number,String],labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,errorMessageAlign:String,submitOnEnter:{type:Boolean,default:!0},validateTrigger:{type:String,default:"onBlur"},showError:{type:Boolean,default:!0},showErrorMessage:{type:Boolean,default:!0}},provide:function(){return{vanForm:this}},data:function(){return{fields:[]}},methods:{getFieldsByNames:function(e){return e?this.fields.filter((function(t){return-1!==e.indexOf(t.name)})):this.fields},validateSeq:function(e){var t=this;return new Promise((function(n,i){var s=[],o=t.getFieldsByNames(e);o.reduce((function(e,t){return e.then((function(){if(!s.length)return t.validate().then((function(e){e&&s.push(e)}))}))}),Promise.resolve()).then((function(){s.length?i(s):n()}))}))},validateFields:function(e){var t=this;return new Promise((function(n,i){var s=t.getFieldsByNames(e);Promise.all(s.map((function(e){return e.validate()}))).then((function(e){e=e.filter((function(e){return e})),e.length?i(e):n()}))}))},validate:function(e){return e&&!Array.isArray(e)?this.validateField(e):this.validateFirst?this.validateSeq(e):this.validateFields(e)},validateField:function(e){var t=this.fields.filter((function(t){return t.name===e}));return t.length?new Promise((function(e,n){t[0].validate().then((function(t){t?n(t):e()}))})):Promise.reject()},resetValidation:function(e){e&&!Array.isArray(e)&&(e=[e]);var t=this.getFieldsByNames(e);t.forEach((function(e){e.resetValidation()}))},scrollToField:function(e,t){this.fields.some((function(n){return n.name===e&&(n.$el.scrollIntoView(t),!0)}))},addField:function(e){this.fields.push(e),(0,s.e)(this.fields,this)},removeField:function(e){this.fields=this.fields.filter((function(t){return t!==e}))},getValues:function(){return this.fields.reduce((function(e,t){return e[t.name]=t.formValue,e}),{})},onSubmit:function(e){e.preventDefault(),this.submit()},submit:function(){var e=this,t=this.getValues();this.validate().then((function(){e.$emit("submit",t)})).catch((function(n){e.$emit("failed",{values:t,errors:n}),e.scrollToError&&e.scrollToField(n[0].name)}))}},render:function(){var e=arguments[0];return e("form",{class:r(),on:{submit:this.onSubmit}},[this.slots()])}})},7141:function(e,t,n){n(1958)},1085:function(e,t,n){n.d(t,{p:function(){return r}});var i=n(1392),s=n(2098),o=n(9345),a=n(789),r=function(e){var t=e.parent,n=e.bem,r=e.role;return{mixins:[(0,o.j)(t),s.f],props:{name:null,value:null,disabled:Boolean,iconSize:[Number,String],checkedColor:String,labelPosition:String,labelDisabled:Boolean,shape:{type:String,default:"round"},bindGroup:{type:Boolean,default:!0}},computed:{disableBindRelation:function(){return!this.bindGroup},isDisabled:function(){return this.parent&&this.parent.disabled||this.disabled},direction:function(){return this.parent&&this.parent.direction||null},iconStyle:function(){var e=this.checkedColor||this.parent&&this.parent.checkedColor;if(e&&this.checked&&!this.isDisabled)return{borderColor:e,backgroundColor:e}},tabindex:function(){return this.isDisabled||"radio"===r&&!this.checked?-1:0}},methods:{onClick:function(e){var t=this,n=e.target,i=this.$refs.icon,s=i===n||(null==i?void 0:i.contains(n));this.isDisabled||!s&&this.labelDisabled?this.$emit("click",e):(this.toggle(),setTimeout((function(){t.$emit("click",e)})))},genIcon:function(){var e=this.$createElement,t=this.checked,s=this.iconSize||this.parent&&this.parent.iconSize;return e("div",{ref:"icon",class:n("icon",[this.shape,{disabled:this.isDisabled,checked:t}]),style:{fontSize:(0,a.N)(s)}},[this.slots("icon",{checked:t})||e(i.Z,{attrs:{name:"success"},style:this.iconStyle})])},genLabel:function(){var e=this.$createElement,t=this.slots();if(t)return e("span",{class:n("label",[this.labelPosition,{disabled:this.isDisabled}])},[t])}},render:function(){var e=arguments[0],t=[this.genIcon()];return"left"===this.labelPosition?t.unshift(this.genLabel()):t.push(this.genLabel()),e("div",{attrs:{role:r,tabindex:this.tabindex,"aria-checked":String(this.checked)},class:n([{disabled:this.isDisabled,"label-disabled":this.labelDisabled},this.direction]),on:{click:this.onClick}},[t])}}}},2098:function(e,t,n){n.d(t,{f:function(){return i}});var i={inject:{vanField:{default:null}},watch:{value:function(){var e=this.vanField;e&&(e.resetValidation(),e.validateWithTrigger("onChange"))}},created:function(){var e=this.vanField;e&&!e.children&&(e.children=this)}}},4755:function(e,t,n){var i=n(2787),s=n(8546),o=n(9341),a=n(1392),r=(0,i.d)("popup"),l=r[0],c=r[1];t["Z"]=l({mixins:[(0,o.e)()],props:{round:Boolean,duration:[Number,String],closeable:Boolean,transition:String,safeAreaInsetBottom:Boolean,closeIcon:{type:String,default:"cross"},closeIconPosition:{type:String,default:"top-right"},position:{type:String,default:"center"},overlay:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0}},beforeCreate:function(){var e=this,t=function(t){return function(n){return e.$emit(t,n)}};this.onClick=t("click"),this.onOpened=t("opened"),this.onClosed=t("closed")},methods:{onClickCloseIcon:function(e){this.$emit("click-close-icon",e),this.close()}},render:function(){var e,t=arguments[0];if(this.shouldRender){var n=this.round,i=this.position,o=this.duration,r="center"===i,l=this.transition||(r?"van-fade":"van-popup-slide-"+i),u={};if((0,s.Xq)(o)){var d=r?"animationDuration":"transitionDuration";u[d]=o+"s"}return t("transition",{attrs:{appear:this.transitionAppear,name:l},on:{afterEnter:this.onOpened,afterLeave:this.onClosed}},[t("div",{directives:[{name:"show",value:this.value}],style:u,class:c((e={round:n},e[i]=i,e["safe-area-inset-bottom"]=this.safeAreaInsetBottom,e)),on:{click:this.onClick}},[this.slots(),this.closeable&&t(a.Z,{attrs:{role:"button",tabindex:"0",name:this.closeIcon},class:c("close-icon",this.closeIconPosition),on:{click:this.onClickCloseIcon}})])])}}})},3474:function(e,t,n){n(1958),n(6196),n(3332),n(6742),n(2666)}}]);